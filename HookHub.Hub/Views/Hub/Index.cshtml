@model HookHub.Hub.Models.CoreHookInfoModel

<style>
    body {
        background: #f5f7fa;
    }

    /* Layout */
    .panel {
        height: calc(100vh - 200px);
        overflow-y: auto;
    }

    /* Grid */
    .client-grid table {
        width: 100%;
        border-collapse: collapse;
        font-size: 0.9rem;
    }

    .client-grid th {
        text-align: left;
        font-size: 0.75rem;
        text-transform: uppercase;
        color: #6c757d;
        border-bottom: 1px solid #dee2e6;
        padding: 8px;
    }

    .client-grid td {
        padding: 8px;
        border-bottom: 1px solid #e9ecef;
    }

    .client-grid tr:hover {
        background: #eef2f7;
        cursor: pointer;
    }

    /* Message log */
    .log-box {
        background: #0e1117;
        color: #d1d5db;
        font-family: Consolas, monospace;
        font-size: 0.85rem;
        padding: 10px;
        border-radius: 8px;
    }

    .log-box ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .log-box li {
        padding: 4px 0;
        border-bottom: 1px dashed #30363d;
    }

    /* Hidden control panel */
    .controls-hidden {
        display: none;
    }
</style>

<div class="container-fluid mt-4">
    <div class="row g-3">

        <!-- CONNECTED CLIENTS GRID -->
        <div class="col-lg-4">
            <div class="card shadow-sm h-100">
                <div class="card-body panel client-grid">

                    <div class="mb-2">
                        <input type="text"
                               id="clientFilter"
                               class="form-control form-control-sm"
                               placeholder="Filter clients..." />
                    </div>

                    <table>
                        <thead>
                            <tr>
                                <th>Client</th>
                            </tr>
                        </thead>
                        <tbody id="listUsers">
                            <!-- JS fills rows -->
                        </tbody>
                    </table>

                </div>
            </div>
        </div>

        <!-- MESSAGE LOG -->
        <div class="col-lg-8">
            <div class="card shadow-sm h-100">
                <div class="card-body panel log-box">
                    <ul id="listMessage"></ul>
                </div>
            </div>
        </div>

        <!-- INVISIBLE CONTROLS -->
        <div class="controls-hidden">
            <input type="button" id="btnRefreshUsers" />
            <input type="button" id="btnConnect" />
            <input type="button" id="btnSend" />

            <input type="text" id="url" readonly value="@Url.Content("~/HOOKHUBNET")" />
            <input type="text" id="hookNameFrom" readonly value="@(Model.HookConnection.HookName)" />
            <input type="text" id="hookNameTo" readonly value="@(Model.HookConnection.HookName)" />
            <input type="text" id="message" />
        </div>

    </div>
</div>

<script src="~/js/signalr.min.js"></script>
<script src="~/js/hub.js"></script>

<script>
    document.getElementById("clientFilter")
        .addEventListener("keyup", function () {
            const filter = this.value.toLowerCase();
            const rows = document.querySelectorAll("#listUsers tr");

            rows.forEach(row => {
                row.style.display =
                    row.textContent.toLowerCase().includes(filter)
                        ? ""
                        : "none";
            });
        });
</script>


